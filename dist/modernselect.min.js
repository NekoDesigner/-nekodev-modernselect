"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var ModernSelect=function(){function s(e,t){var n=this;_classCallCheck(this,s),this.debug=!0,this.value="",this.event={change:"modern-select-change",open:"modern-select-open",close:"modern-select-close"},this.settings={formName:"",icon:"",animation:"slideInDown",customClass:""},this.select="string"==typeof e?document.querySelector(e):e,Object.assign(this.settings,t),this._createSelect(this.settings.formName),window.addEventListener("resize",function(){n._setDropdownHeight(n.optionContainer)}),document.addEventListener("click",function(e){e.target.closest(".modern-select__wrapper")&&e.target.closest(".modern-select__wrapper")==n.select||n.optionContainer.classList.contains("modern-select--dropdown__close")||n.close()})}return _createClass(s,[{key:"value",value:function(t){var n,s;n=!1,this.optionContainer.querySelectorAll("[data-value]").forEach(function(e){e.getAttribute("data-value")==t.toString()&&(n=!0,s=e)}),this.value=t,this.input.value=this.value,n?this._setOutput(s):this.debug&&(console.warn("[MODERN-SELECT][VALUE ERROR]","The value ".concat(t," doesn't exist inside your select. Please, please, make sur your value match with your data-value attribute")),console.warn("[MODERN-SELECT][HELP]","Error on element : ",this.select))}},{key:"close",value:function(){this.optionContainer.classList.add("modern-select--dropdown__close"),this.settings.animation&&(this.optionContainer.classList.remove(this.settings.animation),this.optionContainer.classList.remove("animated")),this._dispatch("close")}},{key:"on",value:function(e,t){var n=this.event[e];this.select.addEventListener(n,function(e){t(e)})}},{key:"_dispatch",value:function(e){var t=new Event(this.event[e]);this.select.dispatchEvent(t)}},{key:"_updateValue",value:function(e){var t=e.target;return e.target.hasAttribute("data-value")||(t=e.target.closest("[data-value]")),this.value!=t.getAttribute("data-value")&&(this.value=t.getAttribute("data-value"),this.input.value=this.value,this._setOutput(t),this._dispatch("change")),this.value}},{key:"_createSelect",value:function(e){var t=this.select.parentElement,n=document.createElement("select"),s=this.select.querySelectorAll("[data-value]"),i=document.createElement("div"),a=document.createElement("div");i.classList.add("modern-select--dropdown"),i.classList.add("modern-select--dropdown__close"),a.classList.add("modern-select--output"),this.settings.customClass&&a.classList.add(this.settings.customClass),s.forEach(function(e){var t=document.createElement("option");t.value=e.getAttribute("data-value"),e.classList.add("modern-select--option"),n.appendChild(t),i.appendChild(e),e.hasAttribute("data-placeholder")&&(e.style.display="none")}),a.innerHTML=s[0].innerHTML,this.select.appendChild(a),this.select.appendChild(i),n.setAttribute("name",e),n.style.display="none",t.appendChild(n),this.output=a,this.optionContainer=i,this.input=n,this._clickListener(a,i),this.select.classList.add("modern-select__wrapper"),this._createIcon(a),this._setValue()}},{key:"_createIcon",value:function(e){if(this.settings.icon){var t=document.createElement("div");t.classList.add("modern-select--icon"),t.innerHTML=this.settings.icon,e.appendChild(t)}}},{key:"_clickListener",value:function(e,t){var n=this;e.addEventListener("click",function(e){e.preventDefault(),n._setDropdownHeight(t),t.classList.toggle("modern-select--dropdown__close"),n.settings.animation&&(t.classList.toggle(n.settings.animation),t.classList.toggle("animated")),t.classList.contains("modern-select--dropdown__close")?n._dispatch("close"):n._dispatch("open")})}},{key:"_setDropdownHeight",value:function(e){var t=e.getBoundingClientRect(),n=window.innerHeight-t.y;e.style.maxHeight=n+"px"}},{key:"_setValue",value:function(){var t=this;this.optionContainer.querySelectorAll("[data-value]").forEach(function(e){e.removeEventListener("click",t._updateValue),e.removeEventListener("click",t.close),e.addEventListener("click",t._updateValue.bind(t)),e.addEventListener("click",t.close.bind(t))})}},{key:"_setOutput",value:function(e){this.output.innerHTML=e.innerHTML,this._createIcon(this.output)}}]),s}();exports.default=ModernSelect;